<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>μ•”νΈν™” & λ³µνΈν™” μ‹¤μµ</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    h1 { color: #333; }
    .container { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); max-width: 700px; margin: auto; }
    label, p { margin: 10px 0; }
    input[type="text"], textarea { width: 100%; padding: 10px; margin-top: 5px; }
    button { padding: 10px 15px; margin-top: 10px; cursor: pointer; }
    pre { background: #eee; padding: 10px; border-radius: 5px; overflow-x: auto; }
    select { padding: 8px; margin-top: 10px; width: 100%; }
  </style>
</head>
<body>
  <div class="container">
    <h1>π” μ•”νΈν™” & λ³µνΈν™” μ‹¤μµ</h1>
    <label for="message">λ©”μ‹μ§€ μ…λ ¥:</label>
    <input type="text" id="message" placeholder="μ: HelloWorld" />

    <label for="method">λ°©μ‹ μ„ νƒ:</label>
    <select id="method">
      <option value="rsa">RSA</option>
      <option value="caesar">μ‹μ €</option>
      <option value="xor">XOR</option>
      <option value="reverse">λ¬Έμ λ°μ „</option>
      <option value="base64">Base64</option>
      <option value="atbash">Atbash</option>
    </select>

    <button onclick="encrypt()">μ•”νΈν™”</button>
    <button onclick="decrypt()">λ³µνΈν™”</button>

    <h3>π“ κ³µμ‹ μ„¤λ…</h3>
    <pre id="formula">μ„ νƒλ λ°©μ‹μ μ•”νΈν™”/λ³µνΈν™” κ³µμ‹μ΄ μ—¬κΈ°μ— ν‘μ‹λ©λ‹λ‹¤.</pre>

    <h3>π“¦ κ²°κ³Ό</h3>
    <p><strong>μ•”νΈλ¬Έ:</strong> <span id="encrypted"></span></p>
    <p><strong>λ³µνΈν™” κ²°κ³Ό:</strong> <span id="decrypted"></span></p>
  </div>

  <script>
    const formulaText = {
      rsa: `RSA κ³µκ°ν‚¤ μ•”νΈν™”:\nμ•”νΈν™”: C = M^e mod n\nλ³µνΈν™”: M = C^d mod n` ,
      caesar: `μ‹μ € μ•”νΈ:\nμ•”νΈν™”: λ¬Έμ μ΄λ™ (μ: +3)\nλ³µνΈν™”: λ¬Έμ μ΄λ™ (-3)` ,
      xor: `XOR μ•”νΈ:\nμ•”νΈν™”: λ¬Έμ β• ν‚¤\nλ³µνΈν™”: λ™μΌν•κ² λ¬Έμ β• ν‚¤` ,
      reverse: `λ¬Έμ λ°μ „:\nμ•”νΈν™” = λ³µνΈν™” = λ¬Έμμ—΄ λ’¤μ§‘κΈ°` ,
      base64: `Base64:\nμ•”νΈν™”: λ¬Έμμ—΄ β†’ base64 μΈμ½”λ”©\nλ³µνΈν™”: base64 β†’ μ›λ λ¬Έμμ—΄` ,
      atbash: `Atbash μ•”νΈ:\nμ•”νΈν™”: μ•νλ²³ λ€μΉ­ λ³€ν™ (Aβ†”Z, Bβ†”Y ...)\nλ³µνΈν™”λ„ λ™μΌ` 
    };

    const rsaKeys = { p: 11, q: 13, n: 143, e: 7, d: 103 };

    function modPow(base, exponent, modulus) {
      let result = 1;
      base %= modulus;
      while (exponent > 0) {
        if (exponent % 2 === 1) result = (result * base) % modulus;
        exponent = Math.floor(exponent / 2);
        base = (base * base) % modulus;
      }
      return result;
    }

    function caesar(text, shift) {
      return text.split('').map(c => {
        const code = c.charCodeAt(0);
        if (c >= 'A' && c <= 'Z') return String.fromCharCode((code - 65 + shift + 26) % 26 + 65);
        if (c >= 'a' && c <= 'z') return String.fromCharCode((code - 97 + shift + 26) % 26 + 97);
        return c;
      }).join('');
    }

    function xor(text, key = 42) {
      return text.split('').map(c => c.charCodeAt(0) ^ key);
    }

    function xorDecrypt(arr, key = 42) {
      return arr.map(c => String.fromCharCode(c ^ key)).join('');
    }

    function base64(text, decode = false) {
      return decode ? atob(text) : btoa(text);
    }

    function atbash(text) {
      return text.split('').map(c => {
        if (c >= 'A' && c <= 'Z') return String.fromCharCode(90 - (c.charCodeAt(0) - 65));
        if (c >= 'a' && c <= 'z') return String.fromCharCode(122 - (c.charCodeAt(0) - 97));
        return c;
      }).join('');
    }

    let lastEncrypted = '';
    let lastEncryptedRaw = [];

    function encrypt() {
      const method = document.getElementById("method").value;
      const msg = document.getElementById("message").value;
      document.getElementById("formula").innerText = formulaText[method];

      let result = '', raw;
      if (method === "rsa") {
        const ascii = msg.split('').map(c => c.charCodeAt(0));
        raw = ascii.map(m => modPow(m, rsaKeys.e, rsaKeys.n));
        result = raw.join(' ');
      } else if (method === "caesar") {
        result = caesar(msg, 3);
      } else if (method === "xor") {
        raw = xor(msg);
        result = raw.join(' ');
      } else if (method === "reverse") {
        result = msg.split('').reverse().join('');
      } else if (method === "base64") {
        result = base64(msg);
      } else if (method === "atbash") {
        result = atbash(msg);
      }
      lastEncrypted = result;
      lastEncryptedRaw = raw;
      document.getElementById("encrypted").innerText = result;
      document.getElementById("decrypted").innerText = '';
    }

    function decrypt() {
      const method = document.getElementById("method").value;
      let result = '';
      if (method === "rsa") {
        const raw = lastEncrypted.split(' ').map(Number);
        result = raw.map(c => String.fromCharCode(modPow(c, rsaKeys.d, rsaKeys.n))).join('');
      } else if (method === "caesar") {
        result = caesar(lastEncrypted, -3);
      } else if (method === "xor") {
        result = xorDecrypt(lastEncryptedRaw);
      } else if (method === "reverse") {
        result = lastEncrypted.split('').reverse().join('');
      } else if (method === "base64") {
        result = base64(lastEncrypted, true);
      } else if (method === "atbash") {
        result = atbash(lastEncrypted);
      }
      document.getElementById("decrypted").innerText = result;
    }
  </script>
</body>
</html>
